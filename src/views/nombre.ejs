<%- include('partials/_header') %>
<div class="container d-flex justify-content-center mt-4">
    <div class="col-md-6">
        <div class="d-grid gap-4">

            <div class="d-flex justify-content-between">
                <h3>Consulta Afiliadxs por Nombre</h3>
                <a class="btn btn-outline-primary btn-sm" href="/dni">Buscar por DNI</a>
            </div>
    
            <div class="form-floating">
                <input type="text" name="nombre" id="nombre" class="form-control" autocomplete="off" placeholder="Nombre" required>
                <label for="nombre">Nombre</label>
            </div>
            <div class="form-floating">
                <input type="text" name="apellido" id="apellido" class="form-control" autocomplete="off" placeholder="Apellido" required>
                <label for="apellido">Apellido</label>
            </div>
    
            <div class="form-floating">
                <input type="number" name="suma" id ="suma" class="form-control" autocomplete="off" placeholder="cuenta" required>
                <label for="suma" class="col-form-label">Escribí el resultado de <%= sum1 %> + <%= sum2 %></label>
            </div>
    
            <button class="btn btn-outline-success btn-lg" aria-describedby="nombre" id="buscar">Buscar</button>

            <div class="alert alert-<%= afiliadx.color + ' ' + afiliadx.display %>"><%= afiliadx.texto %></div>
            <ul class="list-group list-group mb-4 <%= consulta.display %>">
                <% for( let i = 0; i < consulta.length; i++ ) { %>
                    <% if (consulta[i].confirmada === true) { %>
                        <li class="list-group-item list-group-item-success">
                            <%= `${consulta[i].nombre} ${consulta[i].apellido} está afiliadx`%> 
                        </li>
                    <% } else { %>
                        <li class="list-group-item list-group-item-warning">
                            <%=`La afiliación de ${consulta[i].nombre} ${consulta[i].apellido} fue enviada pero rebotó o se cayó :/`%> 
                        </li>
                            
                    <% } %>
                <% } %>
            </ul>
        </div>
    </div>
</div>

<script>
    $('#buscar').click( () => {
        var nombre = $('#nombre').val();
        var apellido = $('#apellido').val();
        var suma = $('#suma').val();

        if (suma > 0 && nombre.length > 0 && apellido.length > 0) {
            $('input').toggleClass('is-invalid',false)
            location.replace(`/nombre/${nombre}/${apellido}/${suma}`)
        } else {
            $('input').toggleClass('is-invalid',true)
        }
    })
</script>
<%- include('partials/_footer') %>